tinymce.PluginManager.add("footnotes-traditional",(function(editor,url){var removeFootnoteLinkByReference=function(reference){for(var footnoteLinks=editor.dom.select('[aria-describedby="footnote-header"]'),i=0;i<footnoteLinks.length;i++)footnoteLinks[i].attributes.href.textContent==reference&&editor.dom.remove(footnoteLinks[i])},removeFootnote=function(){editor.undoManager.transact((function(){if(null!=editor.selection.getNode().attributes["aria-describedby"]){if("footnote-header"==editor.selection.getNode().attributes["aria-describedby"].textContent){var footnoteLinkId=editor.selection.getNode().id,footnoteReference=editor.selection.getNode().attributes.href.textContent.substring(1);editor.dom.remove(footnoteLinkId),editor.dom.remove(footnoteReference)}}else if("footnote-list"==editor.selection.getNode().parentNode.id){var footnoteLinkReference="#"+editor.selection.getNode().id;removeFootnoteLinkByReference(footnoteLinkReference),editor.dom.remove(editor.selection.getNode().id)}else if("footnote-return-link"==editor.selection.getNode().className){var footnoteLinkReference="#"+editor.selection.getNode().parentNode.id;removeFootnoteLinkByReference(footnoteLinkReference),editor.dom.remove(editor.selection.getNode().parentNode.id)}0==editor.dom.select("#footnote-list > li").length&&(editor.dom.remove("footnote-header"),editor.dom.remove("footnote-list"))}))},addFootnote=function(){return editor.windowManager.open({title:"Insert Footnote",body:{type:"panel",items:[{type:"textarea",name:"footnoteContent",multiline:!0,minWidth:520,minHeight:100}]},buttons:[{type:"cancel",text:"Close"},{type:"submit",text:"Save",primary:!0}],onSubmit:function(api){var data=api.getData();editor.undoManager.transact((function(){var list;if(null==editor.dom.get("footnote-list")){var footnoteLink=editor.dom.create("a",{id:"footnote-ref-1",href:"#footnote-1","aria-describedby":"footnote-header"},"[1]");editor.selection.setNode(footnoteLink);var newList=editor.dom.create("ol",{id:"footnote-list"}),newItem=editor.dom.create("li",{id:"footnote-1"},data.footnoteContent),returnLink=editor.dom.create("a",{class:"footnote-return-link",href:"#footnote-ref-1","aria-label":"Back to content"},"&crarr;");newItem.append(returnLink),newList.append(newItem),editor.dom.add(editor.getBody(),"h2",{id:"footnote-header"},"Footnotes"),editor.dom.add(editor.getBody(),newList)}else{var footnoteLink=editor.dom.create("a",{id:"footnote-ref-x",href:"#footnote-x","aria-describedby":"footnote-header"},"[X]");editor.selection.setNode(footnoteLink);var footnoteLinkCount=1,footnoteListCount=1,footnoteInsertPosition=0;if(editor.dom.select('[aria-describedby="footnote-header"]').forEach(element=>{var id;"footnote-ref-x"==editor.dom.getAttrib(element,"id")&&(footnoteInsertPosition=footnoteLinkCount),editor.dom.setAttrib(element,"id","footnote-ref-"+footnoteLinkCount),editor.dom.setAttrib(element,"href","#footnote-"+footnoteLinkCount),editor.dom.setHTML(element,"["+footnoteLinkCount+"]"),footnoteLinkCount++}),1==footnoteInsertPosition){var returnLink=editor.dom.create("a",{class:"footnote-return-link",href:"#footnote-ref-x","aria-label":"Back to content"},"&crarr;"),newItem;(newItem=editor.dom.create("li",{id:"footnote-x"},data.footnoteContent)).append(returnLink),editor.dom.get("footnote-list").prepend(newItem)}editor.dom.select("#footnote-list > li").forEach(element=>{if(footnoteListCount<footnoteInsertPosition-1);else if(footnoteListCount==footnoteInsertPosition-1){var returnLink=editor.dom.create("a",{class:"footnote-return-link",href:"#footnote-ref-"+(footnoteListCount+1),"aria-label":"Back to content"},"&crarr;"),newItem=editor.dom.create("li",{id:"footnote-"+(footnoteListCount+1)},data.footnoteContent);newItem.append(returnLink),editor.dom.insertAfter(newItem,element),footnoteListCount++}else{editor.dom.setAttrib(element,"id","footnote-"+footnoteListCount);var newReturnLink=editor.dom.create("a",{class:"footnote-return-link",href:"#footnote-ref-"+footnoteListCount,"aria-label":"Back to content"},"&crarr;"),oldReturnLink=element.querySelector(".footnote-return-link");editor.dom.insertAfter(newReturnLink,oldReturnLink),oldReturnLink.remove()}footnoteListCount++})}})),api.close()}})};return editor.ui.registry.addIcon("footnote-add",'<svg height="24" width="24" clip-rule="evenodd" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5" version="1.1" viewBox="0 0 24 24" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path d="m16.661 5.497-4.073-2.948h-10.339v18.578h14.412v-15.63z" fill="none" stroke="#000" stroke-width="1.5px"/><path d="m11.361 2.718v4.012h5.014" fill="none" stroke="#000" stroke-width="1.5px"/><path d="m5.328 11.199h4.95" fill="none" stroke="#000" stroke-width="1px"/><path d="m5.328 13.244h7.978" fill="none" stroke="#000" stroke-width="1px"/><rect x="5.303" y="15.674" width="8.074" height="2.625" fill="none" stroke="#000" stroke-width="1px"/><path d="m12.498 10.72h0.53" fill="none" stroke="#000" stroke-width="1px"/><path d="m20.041 9.331h2.331v8.499h-2.331" fill="none" stroke="#000" stroke-width="1.5px"/><path d="m19.769 16.719-0.71 0.984 0.655 1.08" fill="none" stroke="#000" stroke-width="1px"/></svg>'),editor.ui.registry.addIcon("footnote-remove",'<svg height="24" width="24" clip-rule="evenodd" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5" version="1.1" viewBox="0 0 24 24" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path d="m16.661 5.497l-4.073-2.948h-10.339v18.578h14.412v-15.63z" fill="none" stroke="#000" stroke-width="1.5px"/><path d="m11.361 2.718v4.012h5.014" fill="none" stroke="#000" stroke-width="1.5px"/><path d="m5.328 11.199h4.95" fill="none" stroke="#000" stroke-width="1px"/><path d="m5.328 13.244h7.978" fill="none" stroke="#000" stroke-width="1px"/><rect x="5.303" y="15.674" width="8.074" height="2.625" fill="none" stroke="#000" stroke-width="1px"/><path d="m12.498 10.72h0.53" fill="none" stroke="#000" stroke-width="1px"/><path d="m20.041 9.331h2.331v8.499h-2.331" fill="none" stroke="#000" stroke-width="1.5px"/><path d="m19.769 16.719l-0.71 0.984 0.655 1.08" fill="none" stroke="#000" stroke-width="1px"/><path d="m1.34 22.438l19.65-19.651" fill="none" stroke="#000" stroke-width="2px"/></svg>    '),editor.ui.registry.addSplitButton("footnotes-traditional",{icon:"footnote-add",tooltip:"Add a footnote",onAction:function(){addFootnote()},onItemAction:function(api,value){removeFootnote()},fetch:function(callback){var items;callback([{type:"choiceitem",icon:"footnote-remove",text:"Remove Footnote",value:"remove"}])}}),editor.ui.registry.addButton("footnotes-traditional-add",{icon:"footnote-add",tooltip:"Add a footnote",onAction:function(){addFootnote()}}),editor.ui.registry.addButton("footnotes-traditional-remove",{icon:"footnote-remove",tooltip:"Remove a footnote",onAction:function(){removeFootnote()}}),editor.ui.registry.addMenuItem("footnotes-traditional-add",{text:"Add Footnote",icon:"footnote-add",onAction:function(){addFootnote()}}),editor.ui.registry.addMenuItem("footnotes-traditional-remove",{text:"Remove Footnote",icon:"footnote-remove",onAction:function(){removeFootnote()}}),{getMetadata:function(){return{name:"Traditional Footnotes",url:"http://exampleplugindocsurl.com"}}}}));